# D:\quantacore-sdk\integrations\pkcs11\quac100_pkcs11.conf
#
# QUAC 100 PKCS#11 Provider Configuration
#
# This file configures the QUAC 100 PKCS#11 module behavior.
# Copy to one of these locations:
#   - /etc/quac100/pkcs11.conf (system-wide)
#   - ~/.config/quac100/pkcs11.conf (user)
#   - Set QUAC100_PKCS11_CONF environment variable
#
# Copyright 2025 Dyber, Inc. All Rights Reserved.

[general]
# Module name shown in PKCS#11 info
name = "QUAC 100 Post-Quantum HSM"

# Manufacturer ID
manufacturer = "Dyber, Inc."

# Library version
version = 1.0

# Enable debug logging (0=off, 1=errors, 2=warnings, 3=info, 4=debug)
log_level = 1

# Log file path (empty for stderr)
log_file = 

# Enable FIPS mode validation
fips_mode = false

[hardware]
# Hardware acceleration mode
# auto    - Detect and use hardware if available
# always  - Require hardware (fail if not present)
# never   - Always use software implementation
mode = auto

# Device path for hardware accelerator
# Leave empty for auto-detection
device_path = 

# Hardware timeout in milliseconds
timeout_ms = 5000

# Maximum concurrent hardware operations
max_concurrent = 4

# Enable DMA for bulk operations
enable_dma = true

[slots]
# Number of virtual slots (1-16)
slot_count = 1

# Slot descriptions (slot_N_description)
slot_0_description = "QUAC 100 PQC Slot"

# Enable hardware slot detection
auto_detect = true

[token]
# Default token label (padded to 32 bytes)
default_label = "QUAC100 Token"

# Token model string
model = "QUAC-100-HSM"

# Serial number format (auto generates unique ID)
serial_format = "QUAC%08X"

# Token flags
login_required = true
rng_enabled = true
clock_on_token = false

# Session limits (0 = unlimited)
max_sessions = 64
max_rw_sessions = 32

# PIN policies
min_pin_length = 4
max_pin_length = 64
pin_attempts = 3

[algorithms]
# Enable/disable algorithm families
enable_ml_kem = true
enable_ml_dsa = true
enable_slh_dsa = false
enable_hybrid = true

# ML-KEM levels (512, 768, 1024)
ml_kem_levels = 512,768,1024

# ML-DSA levels (44, 65, 87)
ml_dsa_levels = 44,65,87

# Hybrid combinations
hybrid_kem = X25519-ML-KEM-768,P256-ML-KEM-768,P384-ML-KEM-1024
hybrid_sig = Ed25519-ML-DSA-65,P256-ML-DSA-65,P384-ML-DSA-87

# Enable classical algorithms for compatibility
enable_rsa = true
enable_ecdsa = true
enable_ecdh = true
enable_aes = true

[storage]
# Key storage backend
# memory  - In-memory only (lost on restart)
# file    - File-based persistent storage
# sqlite  - SQLite database
backend = file

# Storage path for file/sqlite backends
path = /var/lib/quac100/tokens

# Enable encryption of stored keys
encrypt_storage = true

# Storage encryption key source
# password - Derive from SO PIN
# tpm      - Use TPM-sealed key
# file     - Read from file
encryption_key_source = password

[security]
# Require login for all operations (not just private key ops)
strict_login = false

# Enable sensitive key attribute
enable_sensitive = true

# Enable extractable key attribute (false for HSM-like behavior)
enable_extractable = false

# Wipe memory on session close
secure_cleanup = true

# Side-channel countermeasures
# none    - No countermeasures (fastest)
# basic   - Basic constant-time operations
# full    - Full countermeasures including masking
side_channel_protection = full

# Rate limiting (operations per second, 0 = unlimited)
rate_limit = 0

[performance]
# Thread pool size for async operations
thread_pool_size = 4

# Enable operation batching
enable_batching = true

# Batch size for bulk operations
batch_size = 16

# Cache size for frequently used keys (MB)
key_cache_size = 16

# Prefetch keys on session open
prefetch_keys = true

[compatibility]
# PKCS#11 version to report (2.40 or 3.0)
pkcs11_version = 2.40

# Enable vendor-defined mechanisms
vendor_defined = true

# Map legacy algorithm names
legacy_names = true

# NSS/Mozilla compatibility mode
nss_compat = false

# OpenSC compatibility
opensc_compat = true

[debug]
# Enable performance tracing
trace_performance = false

# Trace file path
trace_file = /tmp/quac100_trace.log

# Enable memory debugging
debug_memory = false

# Dump PKCS#11 calls (WARNING: may expose sensitive data)
dump_calls = false