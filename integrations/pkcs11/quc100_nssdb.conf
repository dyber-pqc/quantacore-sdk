# D:\quantacore-sdk\integrations\pkcs11\quac100_nssdb.conf
#
# QUAC 100 PKCS#11 NSS Database Configuration
#
# This file configures NSS (Network Security Services) to use the
# QUAC 100 PKCS#11 module for post-quantum cryptography operations.
#
# Installation:
#   Linux:   Copy to /etc/pki/nssdb/ or ~/.pki/nssdb/
#   Windows: Use certutil to add module
#   macOS:   Copy to ~/Library/Application Support/Mozilla/
#
# Usage with modutil:
#   modutil -dbdir sql:/etc/pki/nssdb -add "QUAC 100 PQC" \
#           -libfile /usr/lib/libquac100_pkcs11.so
#
# Copyright 2025 Dyber, Inc. All Rights Reserved.

# =============================================================================
# Module Definition
# =============================================================================

# Module name (shown in applications)
name = "QUAC 100 Post-Quantum HSM"

# Library path (adjust for your installation)
# Linux:   /usr/lib/libquac100_pkcs11.so
# Windows: C:\Program Files\Dyber\quac100_pkcs11.dll
# macOS:   /usr/local/lib/libquac100_pkcs11.dylib
library = libquac100_pkcs11.so

# Module parameters
# Format: "configdir=<path> certPrefix=<prefix> keyPrefix=<prefix> flags=<flags>"
parameters = "configdir=/var/lib/quac100"

# NSS flags
# 0x0001 = SECMOD_RSA_FLAG (supports RSA)
# 0x0002 = SECMOD_DSA_FLAG (supports DSA)
# 0x0004 = SECMOD_RC2_FLAG (supports RC2)
# 0x0008 = SECMOD_RC4_FLAG (supports RC4)
# 0x0010 = SECMOD_DES_FLAG (supports DES)
# 0x0020 = SECMOD_DH_FLAG (supports DH)
# 0x0040 = SECMOD_FORTEZZA_FLAG (supports Fortezza)
# 0x0080 = SECMOD_RC5_FLAG (supports RC5)
# 0x0100 = SECMOD_SHA1_FLAG (supports SHA1)
# 0x0200 = SECMOD_MD5_FLAG (supports MD5)
# 0x0400 = SECMOD_MD2_FLAG (supports MD2)
# 0x0800 = SECMOD_SSL_FLAG (SSL/TLS support)
# 0x1000 = SECMOD_TLS_FLAG (TLS support)
# 0x2000 = SECMOD_AES_FLAG (supports AES)
# 0x4000 = SECMOD_SHA256_FLAG (supports SHA256)
# 0x8000 = SECMOD_SHA512_FLAG (supports SHA512)
#
# Custom PQC flags (vendor extension):
# 0x10000 = SECMOD_MLKEM_FLAG
# 0x20000 = SECMOD_MLDSA_FLAG
NSS = flags=internal,critical

# =============================================================================
# Slot Configuration
# =============================================================================

# Slot 0: Main PQC operations
slot 0 = "QUAC 100 Slot 0"

# =============================================================================
# Trust Configuration
# =============================================================================

# Trust flags for the module
# CKT = Certificate Trust
# NSS_USE_SHLIB_PRIVS = Use shared library privileges
# NSS_USE_ALT_RSA_KEY_VALIDATION = Use alternative RSA key validation
trust = CKT

# =============================================================================
# modutil Commands Reference
# =============================================================================
#
# Add module:
#   modutil -dbdir sql:/etc/pki/nssdb -add "QUAC 100" \
#           -libfile /usr/lib/libquac100_pkcs11.so
#
# List modules:
#   modutil -dbdir sql:/etc/pki/nssdb -list
#
# Enable module:
#   modutil -dbdir sql:/etc/pki/nssdb -enable "QUAC 100"
#
# Disable module:
#   modutil -dbdir sql:/etc/pki/nssdb -disable "QUAC 100"
#
# Delete module:
#   modutil -dbdir sql:/etc/pki/nssdb -delete "QUAC 100"
#
# Set default:
#   modutil -dbdir sql:/etc/pki/nssdb -default "QUAC 100" \
#           -mechanisms RSA:DSA:EC:PQC
#
# =============================================================================
# certutil Commands Reference
# =============================================================================
#
# List keys in token:
#   certutil -d sql:/etc/pki/nssdb -K -h "QUAC 100"
#
# Generate key in token:
#   certutil -d sql:/etc/pki/nssdb -G -k ml-dsa -h "QUAC 100" \
#           -n "my-pqc-key" -Z ML-DSA-65
#
# Create self-signed certificate:
#   certutil -d sql:/etc/pki/nssdb -S -n "PQC Test Cert" \
#           -s "CN=test,O=Dyber" -x -t "CT,," -h "QUAC 100" \
#           -k ml-dsa -Z ML-DSA-65
#
# List certificates:
#   certutil -d sql:/etc/pki/nssdb -L -h "QUAC 100"
#
# =============================================================================
# pk12util Commands Reference (PKCS#12 import/export)
# =============================================================================
#
# Import PKCS#12:
#   pk12util -d sql:/etc/pki/nssdb -i cert.p12 -h "QUAC 100"
#
# Export to PKCS#12:
#   pk12util -d sql:/etc/pki/nssdb -o cert.p12 -n "cert-nickname" \
#           -h "QUAC 100"
#
# =============================================================================
# Firefox/Thunderbird Configuration
# =============================================================================
#
# To use with Firefox/Thunderbird:
#
# 1. Open about:config
# 2. Search for "security.enterprise_roots.enabled" and set to true
# 3. Add module via Security Devices dialog:
#    - Settings -> Privacy & Security -> Security Devices
#    - Click "Load"
#    - Enter module name: "QUAC 100 PQC"
#    - Enter module path: /usr/lib/libquac100_pkcs11.so
#
# Or via policies.json:
# {
#   "policies": {
#     "SecurityDevices": {
#       "QUAC 100 PQC": "/usr/lib/libquac100_pkcs11.so"
#     }
#   }
# }
#
# =============================================================================
# Chrome/Chromium Configuration
# =============================================================================
#
# Chrome uses NSS on Linux. Add module to system NSS database:
#
#   modutil -dbdir sql:$HOME/.pki/nssdb -add "QUAC 100" \
#           -libfile /usr/lib/libquac100_pkcs11.so
#
# Or use p11-kit (preferred):
#   1. Create /etc/pkcs11/modules/quac100.module:
#      module: /usr/lib/libquac100_pkcs11.so
#      critical: yes
#
# =============================================================================
# OpenSSL Integration
# =============================================================================
#
# For applications using OpenSSL with engine/provider:
#
# Use QUAC 100 OpenSSL provider instead:
#   export OPENSSL_MODULES=/usr/lib/ossl-modules
#   openssl pkey -provider quac100 ...
#
# Or with pkcs11 engine:
#   export PKCS11_MODULE_PATH=/usr/lib/libquac100_pkcs11.so
#   openssl pkeyutl -engine pkcs11 ...